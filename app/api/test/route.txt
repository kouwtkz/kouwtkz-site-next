import { NextResponse } from "next/server"
import { exec } from "child_process"

async function doCommand() {
  return await new Promise((callback) => {
    exec("pwd; ls", (err, stdout, stderr) => {
      if (err) callback(err);
      console.log(stdout);
      callback(stdout);
    })
  })
}

export async function GET(req: Request) {
  if (/\?/.test(req.url)) {
    return NextResponse.json(await doCommand());
  } else {
    return NextResponse.json("");
  }
}